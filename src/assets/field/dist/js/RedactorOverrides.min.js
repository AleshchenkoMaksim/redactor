var imageResizeClass=$R.classes["image.resize"];imageResizeClass.prototype._setResizerPosition=function(){if(this.$resizer){this.toolbar.isTarget(),this.$target.offset();var e=this.$resizableImage.offset(),t=this.$resizableImage.width(),i=this.$resizableImage.height(),s=this.$resizer.width(),r=this.$resizer.height();this.$resizer.css({top:e.top+i-r+7+"px",left:e.left+t-s+7+"px"})}},imageResizeClass.prototype._build=function(e){this.$target.find("#redactor-image-resizer").remove();var t=this.inspector.parse(e.target),i=this.editor.getElement();t.isComponentType("image")&&(this.$resizableBox=i,this.$resizableImage=$R.dom(t.getImageElement()),this.$resizer=$R.dom("<span>"),this.$resizer.attr("id","redactor-image-resizer"),this.$resizer.css({"z-index":100}),this.$target.append(this.$resizer),this._setResizerPosition(),this.$resizer.on("mousedown touchstart",this._set.bind(this)),this.toolbar.isTarget())},imageResizeClass.prototype.hide=function(){this.$target.find("#redactor-image-resizer").remove(),this.toolbar.isTarget()?this.$target.off("scroll.resizer",this.rebuild.bind(this)):$R.dom("#content-container").off("scroll.resizer",this.rebuild.bind(this))};var toolbarFixedClass=$R.classes["toolbar.fixed"];toolbarFixedClass.prototype.livePreview=!1,toolbarFixedClass.prototype.$previousFixedTarget=!1,toolbarFixedClass.prototype._init=function(){this.$fixedTarget=this.toolbar.isTarget()?this.toolbar.getTargetElement():this.$win,this._doFixed(),this.toolbar.isTarget()&&(this.$win.on("scroll.redactor-toolbar-"+this.uuid,this._doFixed.bind(this)),this.$win.on("resize.redactor-toolbar-"+this.uuid,this._doFixed.bind(this))),this.$fixedTarget.on("scroll.redactor-toolbar-"+this.uuid,this._doFixed.bind(this)),this.$fixedTarget.on("resize.redactor-toolbar-"+this.uuid,this._doFixed.bind(this));var e=()=>{var e=$(".lp-editor");e.length&&(this.livePreview=!0,this.$previousFixedTarget=this.$fixedTarget,(e=$R.dom(e[0])).on("scroll.redactor-toolbar-"+this.uuid,this._doFixed.bind(this)),this.$fixedTarget=e)},t=()=>{this.livePreview=!1,this.$fixedTarget=this.$previousFixedTarget,this.$previousFixedTarget=null};Garnish.on(Craft.Preview,"open",e),Garnish.on(Craft.LivePreview,"enter",e),Garnish.on(Craft.Preview,"close",t),Garnish.on(Craft.LivePreview,"exit",t)},toolbarFixedClass.prototype._doFixed=function(){var e=this.editor.getElement(),t=this.container.getElement(),i=this.toolbar.getElement(),s=this.toolbar.getWrapper();if(!this.editor.isSourceMode()&&0===t.parents().filter((function(e){return"none"===getComputedStyle(e,null).display&&e})).length){var r=e.height()<100,o=this.editor.isEmpty();if(r||o)this.reset();else{var a,h=i.height(),l=0;if(this.livePreview)var d=$(".lp-editor-container header.flex").length?$(".lp-editor-container header.flex").height():0,n=(p=e.offset().top-d)+e.height()-h;else{var p;d=$("body.fixed-header #header").length?$("body.fixed-header #header").height():0,n=(p=e.offset().top-this.$win.scrollTop()-d)+e.height()-h}if(a=p+20<0&&n>0,l=e.scrollTop()+d+20,a){var c=this.detector.isDesktop()?"fixed":"absolute";l=this.detector.isDesktop()?l:scrollOffset-boxOffset+this.opts.toolbarFixedTopOffset,this.detector.isMobile()&&(this.fixedScrollTimeout&&clearTimeout(this.fixedScrollTimeout),i.hide(),this.fixedScrollTimeout=setTimeout((function(){i.show()}),250)),s.height(h),i.addClass("redactor-toolbar-fixed"),i.css({position:c,top:l+this.opts.toolbarFixedTopOffset+"px",width:t.width()+"px"});var g=this.toolbar.getDropdown();g&&g.updatePosition(),this.app.broadcast("toolbar.fixed")}else this.reset(),this.app.broadcast("toolbar.unfixed")}}};var inputCleanerService=$R.services.cleaner;inputCleanerService.prototype.input=function(e,t,i){e=(e=(e=this.encodePreCode(e)).replace(/\$/g,"&#36;")).replace(/&amp;/g,"&"),e=$R.create("cleaner.figure",this.app).convert(e,this.convertRules),e=this.storeComponents(e),e=this.replaceTags(e,this.opts.replaceTags),e=this._setSpanAttr(e),e=this._setStyleCache(e),e=this.removeTags(e,this.deniedTags),e=this.opts.removeScript?this._removeScriptTag(e):this._replaceScriptTag(e),e=this.opts.removeComments?this.removeComments(e):e,e=this._isSpacedEmpty(e)?this.opts.emptyHtml:e,e=this.restoreComponents(e),e=this._cleanWrapped(e);var s=this.utils.buildWrapper(e),r=["alt","title","src","class","width","height","srcset","style"];return s.find("img").each((function(e){if(e.attributes.length>0)for(var t=e.attributes,i=t.length-1;i>=0;i--)-1===t[i].name.search(/^data\-/)&&-1===r.indexOf(t[i].name)&&e.removeAttribute(t[i].name)})),e=this.utils.getWrapperHtml(s),e=t?this.paragraphize(e):e};
//# sourceMappingURL=RedactorOverrides.min.js.map
